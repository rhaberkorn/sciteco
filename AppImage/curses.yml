app: sciteco-curses

ingredients:
  dist: focal
  sources:
    # should always build on the oldest supported version
    - deb http://archive.ubuntu.com/ubuntu/ focal main universe
    - deb http://download.opensuse.org/repositories/home:/rhaberkorn:/sciteco:/UNSTABLE/xUbuntu_20.04/ /
  packages:
    - sciteco-curses
  post_script:
    - dpkg -I sciteco-curses*.deb | sed -En 's/ *Version: *(.*)/\1/p' >VERSION

script:
  # This is currently not installed by sciteco-curses.
  # FIXME: There should perhaps be a unique name in the desktop file, so it does not conflict with the Gtk version.
  - wget -O sciteco-curses.desktop -c "https://raw.githubusercontent.com/rhaberkorn/sciteco/master/src/sciteco.desktop"
  - sed -i -e 's@gsciteco@sciteco@g' sciteco-curses.desktop
  - echo 'Terminal=true' >>sciteco-curses.desktop
  - wget -O sciteco.png -c "https://raw.githubusercontent.com/rhaberkorn/sciteco/master/ico/sciteco-256.png"
  - mkdir -p ./usr/share/metainfo/
  - wget -O ./usr/share/metainfo/sciteco-curses.appdata.xml -c "https://raw.githubusercontent.com/rhaberkorn/sciteco/master/AppImage/sciteco-curses.appdata.xml"
  # Thinning: These documentation files are pointless.
  # SciTECO comes with its own online help system.
  - rm -rf ./usr/share/doc ./usr/share/man
