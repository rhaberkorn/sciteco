app: sciteco-gtk

# We currently use paths hardcoded at build-time.
# Alternatively, it would be possible to customize the AppRun script or
# add a wrapper that sets $SCITECOPATH.
union: true

ingredients:
  packages:
    - sciteco-gtk
  dist: focal
  sources:
    - deb http://archive.ubuntu.com/ubuntu/ focal main universe
#  ppas:
#    - robin-haberkorn/sciteco
  script:
    - wget -c "https://github.com/rhaberkorn/sciteco/releases/download/nightly/sciteco-common_nightly_ubuntu-20.04_all.deb"
    - wget -c "https://github.com/rhaberkorn/sciteco/releases/download/nightly/sciteco-gtk_nightly_ubuntu-20.04_amd64.deb"
  post_script:
    - dpkg -I sciteco-gtk*.deb | grep "Version:" | cut -d':' -f2 | cut -d'+' -f1 | sed 's/^[ ]*//g' >VERSION

script:
  # FIXME: There should perhaps be a unique name in the desktop file, so it does not conflict with the Curses version.
  - mv ./usr/share/applications/sciteco.desktop ./sciteco-gtk.desktop
  - cp ./usr/share/icons/hicolor/256x256/apps/sciteco.png ./sciteco.png
  - rm -rf ./usr/share/icons
  # Thinning: These documentation files are pointless.
  # SciTECO comes with its own online help system.
  - rm -rf ./usr/share/doc ./usr/share/man
